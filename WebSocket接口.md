<!-- TOC -->

- [Websocket 介绍](#Websocket-介绍)
    - [接入方式](#接入方式)
    - [数据压缩](#数据压缩)
    - [心跳信息](#心跳信息)
    - [订阅方式](#订阅方式)
    - [取消订阅](#取消订阅)
- [Websocket 行情推送](#Websocket-行情推送)
    - [订阅合约交易深度](#1-订阅合约交易深度)
    - [订单最新成交记录](#2-订单最新成交记录)
    - [订阅合约k线数据](#3-订阅合约k线数据)

<!-- /TOC -->

# Websocket 介绍

## 接入方式

行情Websocket的接入URL：`wss://open-api-ws.bingx.com/market`

## 数据压缩

WebSocket 行情接口返回的所有数据都进行了 GZIP 压缩，需要 client 在收到数据之后解压。

## 心跳信息

当用户的Websocket客户端连接到Bingx Websocket服务器后，服务器会定期（当前设为5秒）向其发送心跳字符串Ping，

当用户的Websocket客户端接收到此心跳消息后，应返回字符串Pong消息

## 订阅方式

成功建立与Websocket服务器的连接后，Websocket客户端发送如下请求以订阅特定主题：

{
"id": "id1",
"reqType": "sub",
"dataType": "data to sub",
}

成功订阅后，Websocket客户端将收到确认：

{
"id": "id1",
"code": 0,
"msg": "",
}
之后, 一旦所订阅的数据有更新，Websocket客户端将收到服务器推送的更新消息

## 取消订阅
取消订阅的格式如下：

{
"id": "id1",
"reqType": "unsub",
"dataType": "data to unsub",
}

取消订阅成功确认：

{
"id": "id1",
"code": 0,
"msg": "",
}


# Websocket 行情推送

## 1. 订阅逐笔交易

    逐笔交易推送每一笔成交的信息。成交，或者说交易的定义是仅有一个吃单者与一个挂单者相互交易。快照频率为每秒1次。

**订阅类型**

    dataType 为 <symbol>@trade，比如BTC_USDT@trade ETH_USDT@trade

**订阅参数**


| 参数名 | 参数类型  | 必填 | 描述                                            |
| ------------- |----|----|-----------------------------------------------|
| symbol | String | 是 | 合约名称中需有"_"，如BTC_USDT                          |


**推送数据**

| 返回字段     |字段说明|  
|----------|----|
| dataType | 订阅的数据类型，例如 BTC_USDT@trade|
| data     | 推送内容 |
| e        | 事件类型 |
| E        | 事件时间 |
| s        | 交易对  |
| t        | 交易ID | 
| p        | 成交价格 | 
| q        | 成交数量 | 
| T        | 成交时间 |

```javascript
  # Response
{
        "dataType": "BTC_USDT@trade",
        "data": {
            "e": "trade",
            "E": 1649420935293,
            "s": "BTC_USDT",
            "t": "568042",
            "p": "43387.62",
            "q": "0.007007",
            "T": 1649420935163
        }
}
```


## 2. K线 Streams

    K线stream逐秒推送所请求的K线种类(最新一根K线)的更新。

**订阅类型**

    dataType 为 <symbol>@kline_<interval>，比如BTC_USDT@kline_1min

**订阅参数**

| 参数名  | 参数类型  | 必填 | 字段描述 | 描述                   |
| -------|--------|--- |-------|----------------------|
| symbol | String | 是 |合约名称| 合约名称中需有"_"，如BTC_USDT |
| interval | String | 是 |k线类型| 参考字段说明，如分钟，小时，周等 |


**备注**

| klineType 字段说明  | |
| ----------|----|
| 1         | 1m一分钟K线 |
| 3         | 3m三分钟K线 |
| 5         | 5m五分钟K线 |
| 15        | 15m十五分钟K线 |
| 30        | 30m三十分钟K线 |
| 60        | 1h一小时K线 |
| 120       | 2h两小时K线 |
| 240       | 4h四小时K线 |
| 360       | 6h六小时K线 |
| 720       | 12h十二小时K线 |
| 1D        | 1D日K线 |
| 1W        | 1W周K线 |
| 1M        | 1M月K线 |


**推送数据**

| 返回字段     | 字段说明                           |  
|----------|--------------------------------|
| dataType | 订阅的数据类型，例如 BTC_USDT@kline_1min |
| data     | 推送内容                           |
| e        | 事件类型                           |
| E        | 事件时间                           |
| s        | 交易对                            |
| K        | 数据                             |
| t        | 这根K线的起始时间                           |
| T        | 这根K线的结束时间                           |
| s        | 交易对                           |
| i        | K线间隔                           |
| o        | 这根K线期间第一笔成交价                           |
| c        | 这根K线期间末一笔成交价                           |
| h        | 这根K线期间最高成交价                           |
| l        | 这根K线期间最低成交价                           |
| v        | 这根K线期间成交量                           |
| n        | 这根K线期间成交笔数                           |
| q        | 这根K线期间成交额                           |

   ```javascript
    # Response
{
     "dataType": "@kline_BTC_USDT",
            "data": {
                  "e": "kline",
                  "E": 1649421336258,
                  "s": "BTC_USDT",
                  "K": {
                    "t": 1649421300000,
                    "T": 1649421359999,
                    "s": "BTC_USDT",
                    "i": "1min",
                    "o": "43339.98",
                    "c": "43340.39",
                    "h": "43340.89",
                    "l": "43326.31",
                    "v": "0.054111",
                    "n": 22,
                    "q": "2344.999231"
          }
      }
}
   ```

## 3. 有限档深度信息

    每秒推送有限档深度信息。固定20档

**订阅类型**

    dataType 为 <symbol>@depth，比如BTC_USDT@depth

**订阅参数**

| 参数名  | 参数类型  | 必填 | 字段描述 | 描述                   |
| -------|--------|--- |-------|----------------------|
| symbol | String | 是 |合约名称| 合约名称中需有"_"，如BTC_USDT |


**推送数据**

| 返回字段         |字段说明|  
|--------------|----|
| dataType | 订阅的数据类型，例如 BTC_USDT@depth |
| data         | 推送内容 |
| bids         | 变动的买单深度 |
| asks | 变动的卖单深度 |


   ```javascript
    # Response
{
      "dataType": "BTC_USDT@depth",
      "data": {
        "bids": [
              [
                "43302.00", // 变动的价格档位
                "0.000021"  // 数量
              ]
        ],
          "asks": [
              [
                "43499.00", // 变动的价格档位
                "0.000021"  // 数量
              ]
          ]
       }
}
   ```


**备注**

    更多返回错误代码请看首页的错误代码描述